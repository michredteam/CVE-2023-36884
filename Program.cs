using Microsoft.Win32;
using System;

public class Program
{
    public static bool TestRegistryValue(string path, string value, bool showValue)
    {
        try
        {
            RegistryKey registryKey = Registry.LocalMachine.OpenSubKey(path);
            if (registryKey != null)
            {
                object registryValue = registryKey.GetValue(value);
                if (registryValue != null)
                {
                    if (showValue)
                    {
                        Console.WriteLine(registryValue.ToString());
                    }
                    else
                    {
                        return true;
                    }
                }
            }
        }
        catch (Exception)
        {
            return false;
        }

        return false;
    }

    public static void Main()
    {
        string key = @"SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION";
        RegistryKey baseRegistryKey = Registry.LocalMachine;
        RegistryKey subKey = baseRegistryKey.CreateSubKey(key);

        string[] registryValues = { "Graph.exe", "MSAccess.exe", "MSPub.exe", "PowerPoint.exe", "Visio.exe", "WinProj.exe", "WinWord.exe", "WordPad.exe" };

        foreach (string value in registryValues)
        {
            if (!TestRegistryValue(key, value, false))
            {
                subKey.SetValue(value, 1);
            }
        }
    }
}
